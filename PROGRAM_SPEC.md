# 구구단 퀴즈 놀이터 프로그램 명세서

## 1. 목적 및 개요
초등학생 및 학습자가 2~9단(옵션으로 20단까지) 구구단을 쉽고 재미있게 암기할 수 있도록, 웹 기반의 인터랙티브 퀴즈와 학습 이력/리포트를 제공한다. 정답률, 반응 속도, 오답 집중 훈련을 통해 장기 기억과 속도를 향상시키는 것을 목표로 한다.

## 2. 기술 스택
- HTML/CSS/JavaScript (바닐라)
- 로컬 저장: `localStorage`
- TTS: Web Speech API (`speechSynthesis`)
- 차트: Canvas(수동 드로잉)

## 3. 파일 구조
- `index.html` : UI 구조 및 컨테이너 정의
- `style.css` : 전체 테마, 레이아웃, 반응형 스타일
- `script.js` : 앱 로직, 상태 관리, 퀴즈 생성, TTS, 기록 저장

## 4. 화면 구성 (UI)

### 4.1 헤더/히어로 영역
- 배지: “오늘의 구구단”
- 타이틀: “구구단 퀴즈 놀이터”
- 부제: 학습 유도 문구
- 모든 텍스트는 i18n 키로 연결됨

### 4.2 설정 패널
- **언어 선택**: 다국어 드롭다운(ko, en, zh, ja, es, fr, de, pt, vi, th, id)
- **연습할 단 선택**: 2~9단(기본), 옵션 체크 시 2~20단 확장
- **문제 스타일**: `섞어서` / `순서대로`
- **학습 모드**: `기본` / `도전`
- **도전 시간 제한**: 1~5초 슬라이더 (도전 모드에서 표시)
- **문제 수**: 5~20 문제 슬라이더
- **TTS 설정**
  - 자동 읽기 토글
  - 지금 읽기 버튼
  - 언어별 음성 선택 드롭다운

### 4.3 퀴즈 영역
- 하트(생명) 3개
- 별(정답 수) 카운트
- 진행 상황 (현재/총 문제)
- 타이머
  - 기본 모드: 경과 시간
  - 도전 모드: 남은 시간(초)
- 문제 텍스트
- 보기 4개(버튼)
- 피드백 문구
- “모르면 넘어가기”(기본 모드 전용)
- 다음 문제 버튼(자동 진행이 기본)

### 4.4 결과 영역
- 별 개수
- 정답률
- 소요 시간 또는 평균 응답속도(도전 모드)
- 오답 복습 리스트

### 4.5 학습 이력 영역
- 최근 30회 기록
- 성장 그래프(정답률)
- 자주 틀리는 문제 Top 리스트
- 챌린지 모드 리포트
  - 최고 기록(평균 응답 속도)
  - 챌린지 오답 Top 리스트
- 기록 삭제, JSON 내보내기

## 5. 기능 명세

### 5.1 문제 생성 로직
- 선택한 단(`selectedDans`) 기준으로 문제 생성
- 기본 9단, 확장 시 20단
- `섞어서` 모드: 랜덤
- `순서대로` 모드: 단 순환 + 곱 순환
- 보기 생성: 정답 포함 4개 랜덤

### 5.2 오답 가중치
- 과거 오답이 10개 이상인 경우에만 가중치 적용
- 기본 모드: 전체 문제의 50%를 오답 기반으로 구성
- 도전 모드: 전체 문제의 30%를 오답 기반으로 구성
- 오답이 부족하면 일반 랜덤/순서로 채움

### 5.3 도전 모드
- 문제당 제한 시간(1~5초)
- 시간 내 응답 실패 시 자동 오답 처리 및 다음 문제 진행
- 평균 응답 속도(ms → 초 0.00 형식) 계산
- 챌린지 리포트에 기록

### 5.4 자동 진행
- 답 선택 시 0.6초 후 자동 다음 문제
- “모르면 넘어가기”도 동일

### 5.5 키보드 입력
- 숫자키 1~4로 보기 버튼 즉시 선택

### 5.6 TTS(텍스트 음성 읽기)
- 언어별 읽기 문구
- 자동 읽기/수동 읽기 지원
- 언어별 음성 선택 드롭다운
- 기본값: 가능한 경우 구글 음성 우선
- 선택 음성은 언어별로 localStorage 저장

### 5.7 기록 저장
- `localStorage`에 최대 30회 저장
- JSON 내보내기 가능

## 6. 데이터 구조

### 6.1 LocalStorage Keys
- `gugudan-history-v1`
- `gugudan-language`
- `gugudan-voice-<lang>`

### 6.2 History Entry Schema
```json
{
  "date": "2026-01-28T12:34:56.000Z",
  "rate": 90,
  "total": 10,
  "correct": 9,
  "time": "00:32",           // 기본 모드
  "avgTimeMs": 1450,          // 도전 모드
  "timeLimit": 3,
  "wrong": [
    {"dan": 7, "times": 8, "answer": 56, "chosen": 54, "correct": false}
  ],
  "selected": [2,3,4],
  "mode": "mixed",
  "session": "normal"        // or "challenge"
}
```

## 7. i18n 구조
- 모든 UI 문자열은 `data-i18n` 키로 매핑
- `I18N` 객체에 언어별 문자열 정의
- 번역 키 예: `title`, `subtitle`, `modeMixed`, `sessionChallenge` 등

## 8. TTS 문구 예시
- 한국어: “2 곱하기 3”
- 영어: “2 times 3”
- 일본어: “2 かける 3”

## 9. 차트(성장 그래프)
- Canvas 900×260
- 최근 12회 기록의 정답률을 선 그래프로 표현
- 데이터 없을 시 안내 문구 표시

## 10. 예외 처리
- 브라우저에 음성 없음 → TTS 드롭다운 비활성화
- 오답 기록이 부족하면 가중치 비활성화
- 선택 단이 하나만 남을 때는 해제 불가

## 11. 향후 확장 포인트
- 레벨/배지 시스템
- 오답 노트 전용 모드
- 기간별 필터
- TTS 속도/피치 조절
- 서버 연동(계정, 리더보드)

